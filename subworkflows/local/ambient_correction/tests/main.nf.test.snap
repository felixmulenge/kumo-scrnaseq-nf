{
    "Should run with 'none' ambient correction": {
        "content": [
            {
                "0": [
                    [
                        {
                            "id": "test"
                        },
                        "/nf-core/test-datasets/modules/data/genomics/homo_sapiens/scrnaseq/h5ad/SRR28679759_filtered_matrix.h5ad"
                    ]
                ],
                "1": [
                    
                ],
                "h5ad": [
                    [
                        {
                            "id": "test"
                        },
                        "/nf-core/test-datasets/modules/data/genomics/homo_sapiens/scrnaseq/h5ad/SRR28679759_filtered_matrix.h5ad"
                    ]
                ],
                "versions": [
                    
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-29T14:24:32.042514038"
    },
    "Should run with 'decontx' ambient correction to 'X'": {
        "content": [
            [
                "versions.yml:md5,0df227098fc7a061a6c8ba36dd3ef859"
            ],
            "test_decontx.h5ad",
            [
                "ambient_corrected_decontx"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-31T12:48:20.216479462"
    },
    "Should run with 'cellbender' ambient correction to 'X'": {
        "content": [
            {
                "0": [
                    [
                        {
                            "id": "test"
                        },
                        "test.h5ad:md5,4d8d0d4474873c89db514aabe8628d56"
                    ]
                ],
                "1": [
                    "versions.yml:md5,1d70371b0f0ca5e50f7ba70335f8946f",
                    "versions.yml:md5,e6e98e83cbc9a2924c66e901445bbc4f"
                ],
                "h5ad": [
                    [
                        {
                            "id": "test"
                        },
                        "test.h5ad:md5,4d8d0d4474873c89db514aabe8628d56"
                    ]
                ],
                "versions": [
                    "versions.yml:md5,1d70371b0f0ca5e50f7ba70335f8946f",
                    "versions.yml:md5,e6e98e83cbc9a2924c66e901445bbc4f"
                ]
            },
            [
                "ambient_corrected_cellbender"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2026-01-01T10:37:31.070458556"
    },
    "Should run with 'decontx' ambient correction and no batch column": {
        "content": [
            [
                "versions.yml:md5,0df227098fc7a061a6c8ba36dd3ef859"
            ],
            "test_decontx.h5ad",
            [
                "ambient_corrected_decontx"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2026-01-10T13:56:49.20957065"
    },
    "Should run with 'decontx' ambient correction": {
        "content": [
            [
                "versions.yml:md5,0df227098fc7a061a6c8ba36dd3ef859"
            ],
            "test_decontx.h5ad",
            [
                "ambient_corrected_decontx"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-31T12:44:02.240487935"
    },
    "Should run with 'soupx' ambient correction to 'X'": {
        "content": [
            [
                "versions.yml:md5,0c67966bf597df322244bee055ece6b1"
            ],
            "test_soupX.h5ad",
            [
                "ambient_corrected_soupx"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-31T12:49:04.708836272"
    },
    "Should run with 'scar' ambient correction": {
        "content": [
            [
                "versions.yml:md5,2717cb5f250a65aec0a76a456f7028ba"
            ],
            "test.h5ad",
            [
                "ambient_corrected_scar"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2026-01-01T10:22:52.74217591"
    },
    "Should not do anything if ambient correction is disabled in meta": {
        "content": [
            {
                "0": [
                    [
                        {
                            "id": "test",
                            "batch_col": "sample",
                            "counts_layer": "X",
                            "ambient_correction": false
                        },
                        "/nf-core/test-datasets/modules/data/genomics/homo_sapiens/scrnaseq/h5ad/SRR28679759_filtered_matrix.h5ad"
                    ]
                ],
                "1": [
                    
                ],
                "h5ad": [
                    [
                        {
                            "id": "test",
                            "batch_col": "sample",
                            "counts_layer": "X",
                            "ambient_correction": false
                        },
                        "/nf-core/test-datasets/modules/data/genomics/homo_sapiens/scrnaseq/h5ad/SRR28679759_filtered_matrix.h5ad"
                    ]
                ],
                "versions": [
                    
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-29T14:34:48.871481933"
    },
    "Should run with 'cellbender' ambient correction": {
        "content": [
            {
                "0": [
                    [
                        {
                            "id": "test"
                        },
                        "test.h5ad:md5,4d8d0d4474873c89db514aabe8628d56"
                    ]
                ],
                "1": [
                    "versions.yml:md5,1d70371b0f0ca5e50f7ba70335f8946f",
                    "versions.yml:md5,e6e98e83cbc9a2924c66e901445bbc4f"
                ],
                "h5ad": [
                    [
                        {
                            "id": "test"
                        },
                        "test.h5ad:md5,4d8d0d4474873c89db514aabe8628d56"
                    ]
                ],
                "versions": [
                    "versions.yml:md5,1d70371b0f0ca5e50f7ba70335f8946f",
                    "versions.yml:md5,e6e98e83cbc9a2924c66e901445bbc4f"
                ]
            },
            [
                "ambient_corrected_cellbender"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2026-01-01T10:32:08.996381393"
    },
    "Should run with 'soupx' ambient correction": {
        "content": [
            [
                "versions.yml:md5,0c67966bf597df322244bee055ece6b1"
            ],
            "test_soupX.h5ad",
            [
                "ambient_corrected_soupx"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2025-08-31T12:44:43.696601933"
    },
    "Should run with 'scar' ambient correction to 'X'": {
        "content": [
            [
                "versions.yml:md5,2717cb5f250a65aec0a76a456f7028ba"
            ],
            "test.h5ad",
            [
                "ambient_corrected_scar"
            ]
        ],
        "meta": {
            "nf-test": "0.9.2",
            "nextflow": "25.04.6"
        },
        "timestamp": "2026-01-01T10:35:20.300691163"
    }
}